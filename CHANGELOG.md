# CHTL 编译器 - 更新日志

所有重要的项目变更都记录在这个文件中。

---

## [v0.5.0] - 2025-10-14

### ✨ 新增

- **Script 块支持** ⭐
  - `script {}` 块解析
  - ScriptNode AST 节点
  - `<script>` 标签生成
  - 嵌套花括号处理
  - 与 style 块完美结合
  
- **新增示例**
  - `script_demo.chtl` - Script 功能完整演示
  - `simple_todo.chtl` - 交互式 TODO 应用
  - `interactive_app.chtl` - 高级交互应用
  
- **新增文档**
  - `STEP6_PLAN.md` - Step 6 开发计划
  - `STEP6_SUMMARY.md` - Step 6 完成总结
  - `RELEASE_v0.5.0.md` - v0.5.0 发布说明

### 🔧 改进

- **CSS 颜色代码修复**
  - 修复 `#3498db` 拆分为 `# 3498 db` 的问题
  - 支持所有 CSS 颜色格式
  
- **CSS 空格处理优化**
  - 修复 `0 auto` 拆分为 `0auto` 的问题
  - 添加 24 种 CSS 单位识别
  - 智能值拼接逻辑
  
- **文档更新**
  - TUTORIAL.md 添加脚本块章节
  - EXAMPLES.md 添加 3 个新示例
  - README.md 更新统计数据

### 📊 测试

- 测试用例：51 → **56** (+5)
- 断言数量：349 → **380** (+31)
- 通过率：**100%**

**新增测试**:
- `test_script.cpp` - 5 用例，31 断言

---

## [v0.4.0] - 2025-10-14

### ✨ 新增

- **属性运算系统** (CHTL.md 第175-202行)
  - 支持算术运算符：`+ - * / % **`
  - 运算符优先级处理
  - 括号表达式支持
  - 一元运算符 `+` `-`
  - 同单位合并验证
  - 不同单位错误检测
  - 左结合规则实现
  
- **CSSValue 类**
  - 带单位的 CSS 值表示
  - 完整的运算符重载
  - 智能数值格式化
  
- **CSSExpression 解析器**
  - 递归下降表达式解析
  - 自动求值
  
- **新增示例**
  - `advanced_expression.chtl` - 高级表达式演示
  - `complete_website.chtl` - 完整网站示例
  
- **新增文档**
  - `TUTORIAL.md` - 快速教程
  - `EXAMPLES.md` - 示例集合
  - `STEP5_2_PLAN.md` - Step 5.2 计划
  - `STEP5_2_SUMMARY.md` - Step 5.2 总结

### 🔧 改进

- 优化 CLI 帮助信息
- 美化输出格式
- 改进错误提示

### 📊 测试

- 测试用例：39 → **51** (+12)
- 断言数量：303 → **349** (+46)
- 通过率：**100%**

---

## [v0.3.0] - 2025-10-14

### ✨ 新增

- **内联样式系统** (CHTL.md 第109-125行)
  - `style {}` 块解析
  - CSS 属性识别
  - 智能值拼接（100px, 1px solid black, 100%）
  - `style=""` 属性生成
  - 支持所有 CSS 单位和属性
  
- **StyleNode AST 节点**
  - CSS 属性存储
  - 访问者模式支持
  
- **新增示例**
  - `style_demo.chtl` - 样式演示
  
- **新增文档**
  - `STEP5_PLAN.md` - Step 5 详细计划
  - `STEP5_SUMMARY.md` - Step 5.1 总结

### 🔧 改进

- 增强 `Parser::parseStyleBlock()`
- 增强 `Generator::generateElement()`
- 更新 `NodeVisitor` 接口

### 📊 测试

- 测试用例：33 → **39** (+6)
- 断言数量：263 → **303** (+40)
- 通过率：**100%**

---

## [v0.2.5] - 2025-10-14

### 🔒 生产环境加固

- **错误处理系统**
  - `CompilerError` 错误层级
  - 详细错误信息（文件名、行号、列号）
  - 错误严重级别
  
- **资源限制**
  - `CompilerConfig` 配置类
  - 6项资源限制（文件大小、嵌套深度等）
  - DoS 防护
  
- **输入验证**
  - `Validation` 验证类
  - 文件路径验证
  - 标识符验证
  - 路径遍历防护
  
- **日志系统**
  - `Logger` 日志类
  - 分级日志（debug, info, warning, error, fatal）
  - 时间戳支持
  
- **新增测试**
  - `test_production.cpp` - 生产环境测试

### 📊 测试

- 测试用例：25 → **33** (+8)
- 断言数量：221 → **263** (+42)
- 通过率：**100%**

---

## [v0.2.0] - 2025-10-14

### ✨ 新增

- **代码生成器** (Generator)
  - HTML 生成
  - 格式化输出（pretty print）
  - DOCTYPE 支持
  - 自闭合标签处理
  - HTML 转义（XSS 防护）
  - 访问者模式
  
- **新增文档**
  - `STEP4_SUMMARY.md` - Step 4 总结
  - `FINAL_SUMMARY.md` - 累计总结

### 📊 测试

- 测试用例：17 → **25** (+8)
- 断言数量：181 → **221** (+40)
- 通过率：**100%**

---

## [v0.1.5] - 2025-10-14

### ✨ 新增

- **Parser 基础架构**
  - 递归下降解析
  - `ElementNode` 解析
  - `TextNode` 解析
  - 属性解析
  - 嵌套元素支持
  - CE 对等式（`:` 和 `=` 等价）
  - 错误恢复机制
  
- **新增文档**
  - `STEP3_SUMMARY.md` - Step 3 总结

### 📊 测试

- 测试用例：11 → **17** (+6)
- 断言数量：121 → **181** (+60)
- 通过率：**100%**

---

## [v0.1.0] - 2025-10-14

### ✨ 新增

- **CHTL 特殊语法块支持**
  - `[Template]` `[Custom]` `[Import]` 等语法块
  - `@Style` `@Element` 等 @ 前缀关键字
  - `from` `as` `use` 等关键字
  
- **新增文档**
  - `STEP2_SUMMARY.md` - Step 2 总结

### 📊 测试

- 测试用例：7 → **11** (+4)
- 断言数量：63 → **121** (+58)
- 通过率：**100%**

---

## [v0.0.5] - 2025-10-14

### ✨ 新增

- **Lexer 基础功能**
  - Token 定义
  - 基础 tokenize
  - 字符串字面量
  - 数字识别
  - 基础关键字（text, style, script）
  
- **测试框架**
  - Catch2 集成
  - `test_lexer.cpp`

### 📊 测试

- 测试用例：**7**
- 断言数量：**63**
- 通过率：**100%**

---

## [v0.0.1] - 2025-10-14

### ✨ 新增

- **项目初始化**
  - CMake 构建系统
  - 项目目录结构
  - `.gitignore`
  - `build.py` Python 构建脚本
  
- **文档**
  - `README.md`
  - `CHTL.md` (规范)
  - `PROJECT_SETUP.md`
  - `QUICKSTART.md`

---

## 版本说明

### 版本号规则

`v主版本.次版本.修订版本`

- **主版本**: 重大架构变更或不兼容更新
- **次版本**: 新功能添加
- **修订版本**: Bug 修复和小改进

### 当前版本

**v0.4.0-expression-support**
- 85% CHTL.md 规范符合
- 生产环境就绪
- 功能完整

---

## 未来计划

### v0.5.0 (计划中)

可能的功能：
- 引用属性（如果时间允许）
- 条件表达式（如果时间允许）
- 更多优化

### v1.0.0 (目标)

达到条件：
- 90%+ 规范符合度
- 完整的核心功能
- 生产环境验证
- 社区反馈整合

---

**最后更新**: 2025-10-14  
**维护者**: CHTL 团队
