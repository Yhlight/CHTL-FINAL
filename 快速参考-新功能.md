# 🚀 CHTL v1.0 新功能快速参考

**更新日期**: 2025-10-24

---

## 1. 事件绑定操作符 (`&->`)

### 语法

#### 单事件绑定
```chtl
{{selector}} &-> eventName: handler;
```

#### 多事件绑定
```chtl
{{selector}} &-> event1, event2, event3: handler;
```

#### 链式绑定
```chtl
{{selector}} &-> event1: handler1,
             &-> event2: handler2,
             &-> event3: handler3;
```

#### 块形式
```chtl
{{selector}} &-> {
    event1: handler1,
    event2: handler2,
    event3: handler3
};
```

### 示例

```chtl
button {
    style {
        .btn { background: blue; }
    }
    
    script {
        // 单击事件
        {{.btn}} &-> click: () => {
            console.log('Button clicked!');
        };
        
        // 多事件
        {{.btn}} &-> mouseenter, mouseleave: (e) => {
            console.log(e.type);
        };
        
        // 块形式（推荐）
        {{.btn}} &-> {
            click: handleClick,
            mouseenter: handleEnter,
            mouseleave: handleLeave
        };
    }
}
```

---

## 2. 路由系统 (`Router`)

### 基本配置

```chtl
// URL映射
Router {
    url: "/path",
    page: {{#page-id}},
}

// 多个映射
Router {
    url: "/home", "/about",
    page: {{#home}}, {{#about}}
}
```

### 模式设置

```chtl
// History模式 (推荐)
Router {
    mode: "history"
}

// Hash模式
Router {
    mode: "hash"
}
```

### 根配置

```chtl
// 设置根路径
Router {
    root: "/"
}

// 设置根容器
Router {
    root: {{#app}}
}
```

### 完整示例

```chtl
html {
    body {
        nav {
            a { href: "/"; text { "首页" } }
            a { href: "/about"; text { "关于" } }
        }
        
        div { id: "app";
            div { id: "home"; class: "page"; }
            div { id: "about"; class: "page"; }
        }
        
        script {
            // 配置路由
            Router {
                url: "/",
                page: {{#home}},
            }
            
            Router {
                url: "/about",
                page: {{#about}},
            }
            
            Router {
                root: {{#app}},
                mode: "history"
            }
            
            // 链接点击处理
            {{nav a}} &-> click: (e) => {
                e.preventDefault();
                history.pushState(null, '', e.target.href);
                Router.navigate(e.target.href);
            };
        }
    }
}
```

---

## 3. 响应式值 (`$变量$`)

### 语法

```chtl
$variableName$
```

### 在属性中使用

```chtl
div {
    id = $elementId$;
    class = $elementClass$;
}
```

### 在样式中使用

```chtl
div {
    style {
        width: $boxWidth$;
        height: $boxHeight$ * 2;
        left: $posX$ + 10px;
    }
}
```

### 完整示例

```chtl
div {
    class = $boxClass$;
    
    style {
        width: $boxWidth$ + 20px;
        height: $boxHeight$ * 2;
        background-color: $bgColor$;
    }
    
    script {
        // 定义响应式变量
        let boxClass = "container";
        let boxWidth = 100;
        let boxHeight = 50;
        let bgColor = "#007bff";
        
        // 变量可以动态改变
        function resize() {
            boxWidth = window.innerWidth * 0.8;
            boxHeight = window.innerHeight * 0.6;
        }
    }
}
```

---

## 4. 动态属性条件表达式

### 使用增强选择器

```chtl
div {
    id: "box";
    style {
        width: 100px;
    }
}

div {
    style {
        // 使用{{}}实现动态引用
        width: {{#box}}.offsetWidth > 100 ? 200px : 100px;
    }
}
```

### 结合响应式值

```chtl
div {
    style {
        display: $isVisible$ ? "block" : "none";
        opacity: $opacity$ / 100;
    }
    
    script {
        let isVisible = true;
        let opacity = 80;
    }
}
```

---

## 💡 最佳实践

### 事件绑定

**推荐**: 使用块形式，代码更清晰
```chtl
{{element}} &-> {
    click: handleClick,
    mouseenter: handleEnter,
    mouseleave: handleLeave
};
```

**不推荐**: 过长的链式
```chtl
{{element}} &-> click: handler1, &-> mouseenter: handler2, &-> ...
```

### 路由系统

**推荐**: 分离配置
```chtl
// 先定义映射
Router { url: "/home", page: {{#home}} }
Router { url: "/about", page: {{#about}} }

// 再设置模式
Router { mode: "history" }
```

**不推荐**: 混在一起
```chtl
Router {
    url: "/home",
    page: {{#home}},
    mode: "history"
}
```

### 响应式值

**推荐**: 有意义的变量名
```chtl
let $containerWidth$ = 800;
let $primaryColor$ = "#007bff";
```

**不推荐**: 简短无意义的名字
```chtl
let $w$ = 800;
let $c$ = "#007bff";
```

---

## 🔍 调试技巧

### 检查生成的代码

```bash
./chtl input.chtl --output output.html
cat output.html  # 查看生成的HTML
```

### 运行测试

```bash
cd CHTL/build
./tests/NewFeaturesTest -s  # 详细输出
```

### 常见问题

**Q: 事件绑定不工作？**
A: 确保使用了增强选择器 `{{...}}`

**Q: 路由跳转失败？**
A: 检查页面元素是否有正确的id/class

**Q: 响应式值未更新？**
A: 确保变量在script块中正确定义

---

## 📚 相关文档

- 完整语言规范: `CHTL.md`
- 实施报告: `IMPLEMENTATION_COMPLETE.md`
- 技术报告: `FINAL_REPORT.md`
- 项目状态: `PROJECT_STATUS.md`
- 路线图: `ROADMAP.md`

---

## 🎯 版本信息

**版本**: CHTL v1.0.0  
**发布日期**: 2025-10-24  
**状态**: 生产就绪  
**许可**: MIT

---

**快速开始**: 运行 `python3 build.py` 开始使用！
